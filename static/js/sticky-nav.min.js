(function() {
const stickyNav = document.querySelector('.sticky-nav');
if (!stickyNav || !document.body.dataset.stickyNavHideOnScroll) {
return;
}
let lastScrollTop = window.pageYOffset || document.documentElement.scrollTop;
let isScrolling   = false;
const threshold   = 5;
function closeAllDropdowns() {
document.querySelectorAll('.nav-dropdown[data-open="true"]').forEach(function(dropdown) {
dropdown.setAttribute('data-open', 'false');
const toggle = dropdown.querySelector('.nav-dropdown-toggle');
if (toggle) {
toggle.setAttribute('aria-expanded', 'false');
}
});
}
function handleScroll() {
if (isScrolling) {
return;
}
isScrolling = true;
requestAnimationFrame(() => {
const scrollTop  = window.pageYOffset || document.documentElement.scrollTop;
const scrollDiff = Math.abs(scrollTop - lastScrollTop);
if (scrollDiff > threshold) {
if (scrollTop > 100) {
if (scrollTop > lastScrollTop) {
stickyNav.classList.add('nav-hidden');
closeAllDropdowns();
} else {
stickyNav.classList.remove('nav-hidden');
}
} else {
stickyNav.classList.remove('nav-hidden');
}
lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
}
isScrolling = false;
});
}
window.addEventListener('scroll', handleScroll, { passive: true });
})();